{% extends 'base.html' %} {% load static %} {% block title %}Register |
PetRescue{% endblock %} {% block head_extra %}
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
  .toggle-password {
    cursor: pointer;
    padding: 0.375rem 0.75rem;
  }
  .password-field {
    position: relative;
  }
</style>
{% endblock %} {% block content %}
<div class="container mt-4" style="max-width: 500px">
  <div class="card shadow-sm p-4">
    <h2 class="text-center mb-4">Create Account</h2>

    <form method="POST" novalidate>
      {% csrf_token %} {% for field in form %}
      <div class="mb-3">
        {{ field.label_tag }} 
        <div class="input-group">
          {{ field }}
          {% if field.name == 'password1' or field.name == 'password2' %}
          <button class="btn btn-outline-secondary toggle-password" type="button" data-target="{{ field.id_for_label }}">
            <i class="fa-solid fa-eye"></i>
          </button>
          {% endif %}
        </div>
        {% for error in field.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %} {% if field.name == 'email' %}
        <div id="email-status" class="mt-1"></div>
        {% endif %}
      </div>
      {% endfor %}

      <button type="submit" class="btn btn-success w-100">Register</button>
    </form>

    <p class="mt-3 text-center">
      Already have an account? <a href="{% url 'login' %}">Sign in here</a>.
    </p>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    // Email validation
    $("#id_email").on("keyup change", function () {
      let email = $(this).val();
      if (email.length > 3) {
        $.ajax({
          url: "{% url 'validate_email' %}",
          data: { email: email },
          dataType: "json",
          success: function (data) {
            if (data.is_taken) {
              $("#email-status").html(
                '<span style="color: red;">&#10008; Email already taken</span>'
              );
            } else {
              $("#email-status").html(
                '<span style="color: green;">&#10004; Email available</span>'
              );
            }
          },
        });
      } else {
        $("#email-status").html("");
      }
    });

    // Toggle password visibility
    $('.toggle-password').on('click', function() {
      var targetId = $(this).data('target');
      var targetField = $('#' + targetId);
      var icon = $(this).find('i');
      
      if (targetField.attr('type') === 'password') {
        targetField.attr('type', 'text');
        icon.removeClass('fa-eye').addClass('fa-eye-slash');
      } else {
        targetField.attr('type', 'password');
        icon.removeClass('fa-eye-slash').addClass('fa-eye');
      }
    });
  });
</script>

{% endblock %}